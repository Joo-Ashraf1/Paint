<div class="menu-bar">
    <div class="file-actions">
        <!-- LOAD MENU -->
        <div class="action-group-container">
            <div class="action-group" (click)="toggleLoadMenu()">
                <span class="action-label">load from</span>
                <div class="triangle-down"></div>
            </div>

            <!-- Dropdown -->
            @if (isLoadMenuOpen) {
            <div class="dropdown-menu">
                <div class="dropdown-item" (click)="onLoadOption('json')">
                    JSON File (.json)
                </div>
                <div class="dropdown-item" (click)="onLoadOption('xml')">
                    XML File (.xml)
                </div>
            </div>
            }
        </div>

        <!-- SAVE MENU -->
        <div class="action-group-container">
            <div class="action-group" (click)="toggleSaveMenu()">
                <span class="action-label">save to</span>
                <div class="triangle-down"></div>
            </div>

            <!-- Dropdown -->
            @if (isSaveMenuOpen) {
            <div class="dropdown-menu">
                <div class="dropdown-item" (click)="onSaveOption('json')">
                    JSON File (.json)
                </div>
                <div class="dropdown-item" (click)="onSaveOption('xml')">
                    XML File (.xml)
                </div>
            </div>
            }
        </div>

        <!-- FILENAME INPUT (Moved to the right of Save) -->
        <div class="filename-group">
            <input type="text" [ngModel]="filename()" (ngModelChange)="filename.set($event)" class="filename-input" placeholder="Enter file name">
        </div>
    </div>

    <div class="history-actions">
        <!-- Copy Button -->
        <div class="history-btn" title="Copy" [class.selected]="isSelected('copy')" (click)="emitToParent('copy')">
            <span class="arrow-icon copy-icon">⧉</span>
            <span class="action-label">copy</span>
        </div>

        <!-- Undo Button -->
        <div class="history-btn" title="Undo" [class.flash]="flashUndo" (mousedown)="triggerFlash('undo')"
            (click)="sendUndoRequest()" (animationend)="onFlashEnd()">
            <span class="arrow-icon undo-icon">↶</span>
            <span class="action-label">undo</span>
        </div>

        <!-- Redo Button -->
        <div class="history-btn" title="Redo" [class.flash]="flashRedo" (mousedown)="triggerFlash('redo')"
            (click)="sendRedoRequest()" (animationend)="onFlashEnd()">
            <span class="arrow-icon redo-icon">↷</span>
            <span class="action-label">redo</span>
        </div>
    </div>
</div>

<!-- CUSTOM SAVE MODAL -->
@if (isSaveModalOpen) {
<div class="modal-overlay">
    <div class="modal-window">
        <div class="modal-header">
            <span>Save As</span>
            <button class="close-btn" (click)="cancelSave()">×</button>
        </div>
        <div class="modal-body">
            <div class="input-row">
                <label>Save in:</label>
                <input type="text" [(ngModel)]="mockDirectory" class="modal-input">
            </div>
            <div class="input-row">
                <label>File name:</label>
                <input type="text" [value]="filename() + '.' + selectedFormat" readonly class="modal-input readonly">
            </div>
            <div class="input-row">
                <label>Save as type:</label>
                <select disabled class="modal-input">
                    <option>{{ selectedFormat.toUpperCase() }} File</option>
                </select>
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn cancel" (click)="cancelSave()">Cancel</button>
            <button class="modal-btn save" (click)="confirmSave()">Save</button>
        </div>
    </div>
</div>
}

<!-- CUSTOM LOAD MODAL (No List, Just Inputs) -->
@if (isLoadModalOpen) {
<div class="modal-overlay">
    <div class="modal-window">
        <div class="modal-header">
            <span>Open</span>
            <button class="close-btn" (click)="cancelLoad()">×</button>
        </div>
        <div class="modal-body">
            <div class="input-row">
                <label>Look in:</label>
                <input type="text" [(ngModel)]="mockDirectory" class="modal-input">
            </div>

            <!-- Just an input to type the filename now, list removed -->
            <div class="input-row">
                <label>File name:</label>
                <input type="text" [(ngModel)]="fileToLoadInput" class="modal-input"
                    placeholder="Type filename to load...">
            </div>

            <div class="input-row">
                <label>Files of type:</label>
                <select disabled class="modal-input">
                    <option>{{ selectedFormat.toUpperCase() }} Files (*.{{selectedFormat}})</option>
                </select>
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn cancel" (click)="cancelLoad()">Cancel</button>
            <button class="modal-btn save" (click)="confirmLoad()">Open</button>
        </div>
    </div>
</div>
}